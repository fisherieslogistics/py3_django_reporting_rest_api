---
- config:
    - testset: "FLL API tests"

- test:
    - name: "Login"
    - method: POST
    - headers: {"Content-Type": "application/json"}
    - url: "/api-token-auth/"
    - body: '{"username": "resttester", "password": "testrester"}'
    - extract_binds:
         - 'jwt': {'jsonpath_mini': 'token'}
    
- test:
    - name: "Create port"
    - headers: {template: {"Authorization": "JWT $jwt", "Content-Type": "application/json"}}
    - method: POST
    - body: '{"name": "Port of Timaru", "location": {"lat": 45, "lon": 45}}'
    - url: "/ports/"
    - extract_binds: 
        - 'port_id': {'jsonpath_mini': 'id'}

- test:
    - name: "Create vessel"
    - headers: {template: {"Authorization": "JWT $jwt", "Content-Type": "application/json"}}
    - method: POST
    - body: '{"name": "Sea Ward", "registration": 12}'
    - url: "/vessels/"

    